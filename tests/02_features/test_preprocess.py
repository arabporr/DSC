import numpy as np
import pandas as pd


df = pd.read_csv("data/02_processed/European_Vanilla_processed_dataset.csv")

assert df.isna().sum().sum() == 0
assert np.isfinite(df.select_dtypes(include=[float])).all().all()

expected = set(
    [
        "stock_price",
        "strike_price",
        "time_to_maturity",
        "interest_rate",
        "volatility",
        "dividend_yield",
        "1_over_T",
        "log_T",
        "sqrt_T",
        "log1p_T",
        "variance",
        "stock_over_strike",
        "strike_over_stock",
        "volatility_over_interest",
        "dividend_yield_over_interest",
        "stock_price_over_interest",
        "interest_rate_over_volatility",
        "dividend_yield_over_volatility",
        "stock_price_over_volatility",
        "stock_price_times_strike_price",
        "stock_price_times_time_to_maturity",
        "stock_price_times_interest_rate",
        "stock_price_times_volatility",
        "stock_price_times_dividend_yield",
        "stock_price_times_1_over_T",
        "stock_price_times_log_T",
        "stock_price_times_sqrt_T",
        "stock_price_times_log1p_T",
        "stock_price_times_variance",
        "stock_price_times_stock_over_strike",
        "stock_price_times_strike_over_stock",
        "stock_price_times_volatility_over_interest",
        "stock_price_times_dividend_yield_over_interest",
        "stock_price_times_stock_price_over_interest",
        "stock_price_times_interest_rate_over_volatility",
        "stock_price_times_dividend_yield_over_volatility",
        "stock_price_times_stock_price_over_volatility",
        "strike_price_times_time_to_maturity",
        "strike_price_times_interest_rate",
        "strike_price_times_volatility",
        "strike_price_times_dividend_yield",
        "strike_price_times_1_over_T",
        "strike_price_times_log_T",
        "strike_price_times_sqrt_T",
        "strike_price_times_log1p_T",
        "strike_price_times_variance",
        "strike_price_times_stock_over_strike",
        "strike_price_times_strike_over_stock",
        "strike_price_times_volatility_over_interest",
        "strike_price_times_dividend_yield_over_interest",
        "strike_price_times_stock_price_over_interest",
        "strike_price_times_interest_rate_over_volatility",
        "strike_price_times_dividend_yield_over_volatility",
        "strike_price_times_stock_price_over_volatility",
        "time_to_maturity_times_interest_rate",
        "time_to_maturity_times_volatility",
        "time_to_maturity_times_dividend_yield",
        "time_to_maturity_times_1_over_T",
        "time_to_maturity_times_log_T",
        "time_to_maturity_times_sqrt_T",
        "time_to_maturity_times_log1p_T",
        "time_to_maturity_times_variance",
        "time_to_maturity_times_stock_over_strike",
        "time_to_maturity_times_strike_over_stock",
        "time_to_maturity_times_volatility_over_interest",
        "time_to_maturity_times_dividend_yield_over_interest",
        "time_to_maturity_times_stock_price_over_interest",
        "time_to_maturity_times_interest_rate_over_volatility",
        "time_to_maturity_times_dividend_yield_over_volatility",
        "time_to_maturity_times_stock_price_over_volatility",
        "interest_rate_times_volatility",
        "interest_rate_times_dividend_yield",
        "interest_rate_times_1_over_T",
        "interest_rate_times_log_T",
        "interest_rate_times_sqrt_T",
        "interest_rate_times_log1p_T",
        "interest_rate_times_variance",
        "interest_rate_times_stock_over_strike",
        "interest_rate_times_strike_over_stock",
        "interest_rate_times_volatility_over_interest",
        "interest_rate_times_dividend_yield_over_interest",
        "interest_rate_times_stock_price_over_interest",
        "interest_rate_times_interest_rate_over_volatility",
        "interest_rate_times_dividend_yield_over_volatility",
        "interest_rate_times_stock_price_over_volatility",
        "volatility_times_dividend_yield",
        "volatility_times_1_over_T",
        "volatility_times_log_T",
        "volatility_times_sqrt_T",
        "volatility_times_log1p_T",
        "volatility_times_variance",
        "volatility_times_stock_over_strike",
        "volatility_times_strike_over_stock",
        "volatility_times_volatility_over_interest",
        "volatility_times_dividend_yield_over_interest",
        "volatility_times_stock_price_over_interest",
        "volatility_times_interest_rate_over_volatility",
        "volatility_times_dividend_yield_over_volatility",
        "volatility_times_stock_price_over_volatility",
        "dividend_yield_times_1_over_T",
        "dividend_yield_times_log_T",
        "dividend_yield_times_sqrt_T",
        "dividend_yield_times_log1p_T",
        "dividend_yield_times_variance",
        "dividend_yield_times_stock_over_strike",
        "dividend_yield_times_strike_over_stock",
        "dividend_yield_times_volatility_over_interest",
        "dividend_yield_times_dividend_yield_over_interest",
        "dividend_yield_times_stock_price_over_interest",
        "dividend_yield_times_interest_rate_over_volatility",
        "dividend_yield_times_dividend_yield_over_volatility",
        "dividend_yield_times_stock_price_over_volatility",
        "1_over_T_times_log_T",
        "1_over_T_times_sqrt_T",
        "1_over_T_times_log1p_T",
        "1_over_T_times_variance",
        "1_over_T_times_stock_over_strike",
        "1_over_T_times_strike_over_stock",
        "1_over_T_times_volatility_over_interest",
        "1_over_T_times_dividend_yield_over_interest",
        "1_over_T_times_stock_price_over_interest",
        "1_over_T_times_interest_rate_over_volatility",
        "1_over_T_times_dividend_yield_over_volatility",
        "1_over_T_times_stock_price_over_volatility",
        "log_T_times_sqrt_T",
        "log_T_times_log1p_T",
        "log_T_times_variance",
        "log_T_times_stock_over_strike",
        "log_T_times_strike_over_stock",
        "log_T_times_volatility_over_interest",
        "log_T_times_dividend_yield_over_interest",
        "log_T_times_stock_price_over_interest",
        "log_T_times_interest_rate_over_volatility",
        "log_T_times_dividend_yield_over_volatility",
        "log_T_times_stock_price_over_volatility",
        "sqrt_T_times_log1p_T",
        "sqrt_T_times_variance",
        "sqrt_T_times_stock_over_strike",
        "sqrt_T_times_strike_over_stock",
        "sqrt_T_times_volatility_over_interest",
        "sqrt_T_times_dividend_yield_over_interest",
        "sqrt_T_times_stock_price_over_interest",
        "sqrt_T_times_interest_rate_over_volatility",
        "sqrt_T_times_dividend_yield_over_volatility",
        "sqrt_T_times_stock_price_over_volatility",
        "log1p_T_times_variance",
        "log1p_T_times_stock_over_strike",
        "log1p_T_times_strike_over_stock",
        "log1p_T_times_volatility_over_interest",
        "log1p_T_times_dividend_yield_over_interest",
        "log1p_T_times_stock_price_over_interest",
        "log1p_T_times_interest_rate_over_volatility",
        "log1p_T_times_dividend_yield_over_volatility",
        "log1p_T_times_stock_price_over_volatility",
        "variance_times_stock_over_strike",
        "variance_times_strike_over_stock",
        "variance_times_volatility_over_interest",
        "variance_times_dividend_yield_over_interest",
        "variance_times_stock_price_over_interest",
        "variance_times_interest_rate_over_volatility",
        "variance_times_dividend_yield_over_volatility",
        "variance_times_stock_price_over_volatility",
        "stock_over_strike_times_strike_over_stock",
        "stock_over_strike_times_volatility_over_interest",
        "stock_over_strike_times_dividend_yield_over_interest",
        "stock_over_strike_times_stock_price_over_interest",
        "stock_over_strike_times_interest_rate_over_volatility",
        "stock_over_strike_times_dividend_yield_over_volatility",
        "stock_over_strike_times_stock_price_over_volatility",
        "strike_over_stock_times_volatility_over_interest",
        "strike_over_stock_times_dividend_yield_over_interest",
        "strike_over_stock_times_stock_price_over_interest",
        "strike_over_stock_times_interest_rate_over_volatility",
        "strike_over_stock_times_dividend_yield_over_volatility",
        "strike_over_stock_times_stock_price_over_volatility",
        "volatility_over_interest_times_dividend_yield_over_interest",
        "volatility_over_interest_times_stock_price_over_interest",
        "volatility_over_interest_times_interest_rate_over_volatility",
        "volatility_over_interest_times_dividend_yield_over_volatility",
        "volatility_over_interest_times_stock_price_over_volatility",
        "dividend_yield_over_interest_times_stock_price_over_interest",
        "dividend_yield_over_interest_times_interest_rate_over_volatility",
        "dividend_yield_over_interest_times_dividend_yield_over_volatility",
        "dividend_yield_over_interest_times_stock_price_over_volatility",
        "stock_price_over_interest_times_interest_rate_over_volatility",
        "stock_price_over_interest_times_dividend_yield_over_volatility",
        "stock_price_over_interest_times_stock_price_over_volatility",
        "interest_rate_over_volatility_times_dividend_yield_over_volatility",
        "interest_rate_over_volatility_times_stock_price_over_volatility",
        "dividend_yield_over_volatility_times_stock_price_over_volatility",
        "option_type_put",
        "black_scholes_price",
    ]
)
assert expected.issubset(set(df.columns))

subset = [
    "stock_price",
    "strike_price",
    "time_to_maturity",
    "interest_rate",
    "volatility",
    "dividend_yield",
]
assert df.duplicated(subset=subset).sum() == (len(df) / 2)
